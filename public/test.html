<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <link rel="stylesheet" href="/style.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
      .flex-shrink-0 {
          background-color: #f8f9fa; /* 輕柔的背景色 */
          border-radius: 15px; /* 圓角效果 */
          box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); /* 輕微的陰影 */
          padding: 20px;
      }
  
      .btn-toggle {
          background-color: #d0cfe8; /* 亮藍色背景 */
          color: rgb(0, 0, 0); /* 白色文字 */
          margin-bottom: 10px; /* 按鈕間距 */
      }
  
      .btn-toggle:hover {
          background-color: #0056b3; /* 滑鼠懸停時的背景顏色 */
      }
  
      .link-body-emphasis {
          color: #ffffff; /* 亮藍色鏈接 */
          font-weight: bold; /* 粗體字 */
      }
  
      .list-unstyled {
          padding-left: 0; /* 移除預設的左側間距 */
      }
  
      .list-unstyled li a {
          display: block; /* 讓鏈接佔滿整個區域 */
          padding: 5px 10px; /* 鏈接的間距 */
      }
  
      .list-unstyled li a:hover {
          background-color: #e7e7e7; /* 滑鼠懸停時的背景顏色 */
          border-radius: 10px; /* 圓角效果 */
      }
    
    .custom-card {
        box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1); /* 陰影效果 */
        background-color: #f2efe9; /* 米色背景 */
        padding: 15px;
    }
  </style>
  
  </head>
  <body>
    <nav class="navbar navbar-expand-lg " id="nav-color">
        <a class="navbar-brand" href="test.html" style="font-weight: bold">
        <img src="medical_icon.png" alt="Logo" width="40" height="40"> 醫療小幫手</a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link" href="test.html" style="font-weight: bold">
                <img src="home_icon.png" alt="Logo" width="25" height="25"> 首頁</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="medical_form" href="medical_form.html" style="font-weight: bold">
                  <img src="leaflet.png" alt="Logo" width="25" height="25"> 手術問卷</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="leaflets_change" href="health_leaflet.html" style="font-weight: bold">
                  <img src="leaflet2.png" alt="Logo" width="28" height="28"> 衛教單張管理</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" id="personal_medicalcare" href="personal_medicalcare.html" style="font-weight: bold">
                <img src="personal_medical.png" alt="Logo" width="30" height="30" > 個人醫療</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="userinfo_change" href="user_info_modifiy.html" style="font-weight: bold">
                  <img src="modify.png" alt="Logo" width="28" height="28"> 用戶基本資料修改</a>
              </li>
            <li class="nav-item">
                <a class="nav-link" id="response" href="user_feedback.html" style="font-weight: bold">
                  <img src="reply2.png" alt="Logo" width="30" height="30"> 回饋</a>
            </li> 
            <li class="nav-item">
              <a class="nav-link" id="manager_response" href="manager_response.html" style="font-weight: bold">
                <img src="reply2.png" alt="Logo" width="30" height="30"> 回饋</a>
          </li> 
          </ul>
          <div class="ms-auto">
            <a class="btn btn-light" href="user_login.html" id="login-button">登入</a>
            <a class="btn btn-light" href="signup.html" id="signup-button">註冊</a>
            <a class="btn btn-light" href="#" id="logout-button" style="display: none;">登出</a>
          </div>
          <div id="userNameDisplay" class="user-name-display"></div>
          <!-- <form class="d-flex" role="search">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success" type="submit">Search</button>
          </form>  -->
            <!-- 用戶名稱將在這裡顯示 -->
        
        </div>
    </nav>
    <!--導覽頁-->
    <div class=" mt-4">
        <div class="row">
            <div class="col-lg-3">
              <div class="flex-shrink-0 p-3" style="width: 280px;">
                <ul class="list-unstyled ps-0">
                  <li class="mb-1">
                    <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#home-collapse" aria-expanded="true">
                    護理指導
                    </button>
                    <div class="collapse show" id="home-collapse">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">目錄總覽</a></li>
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">文件總覽</a></li>
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">最新討論</a></li>
                    </ul>
                    </div>
                </li>
                <li class="mb-1">
                    <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-expanded="false">
                    科別
                </button>
                    <div class="collapse" id="dashboard-collapse">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">神經內科</a></li>
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">神經外科</a></li>
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">精神病</a></li>
                        <li><a href="heart_leaflet.html" class="link-body-emphasis d-inline-flex text-decoration-none rounded">心臟內科</a></li>
                        <li><a href="bone_leaflets.html" class="link-body-emphasis d-inline-flex text-decoration-none rounded">骨科</a></li>
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">胸腔外科</a></li>
                    </ul>
                    </div>
                </li>
          
                <li class="border-top my-3"></li>
                <li class="mb-1">
                    <button class="btn btn-toggle d-inline-flex align-items-center rounded border-0 collapsed" data-bs-toggle="collapse" data-bs-target="#account-collapse" aria-expanded="false">
                    Account
                    </button>
                    <div class="collapse" id="account-collapse">
                    <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
                        <li><a href="user_login.html" class="link-body-emphasis d-inline-flex text-decoration-none rounded">Log in...</a></li>
                        <li><a href="signin.html" class="link-body-emphasis d-inline-flex text-decoration-none rounded">Sign in...</a></li>
                        <li><a href="user_login.html" class="link-body-emphasis d-inline-flex text-decoration-none rounded">Settings</a></li>
                        <li><a href="#" class="link-body-emphasis d-inline-flex text-decoration-none rounded">Sign out</a></li>
                    </ul>
                    </div>
                </li>
                </ul>
            </div>
          </div>
          <div class="col-lg-8">
            <div class="row">
                <!-- 第一个主要内容区块 -->
                <div class="col-lg-6 mb-4">
                    <div class="card custom-card">
                        <div class="card-body">
                            <h2 class="card-title" href="fake_leaflet_bone.html">人工髖關節置換術手術前後照護</h2>
                            <img width="320" height="180" src="bone.jpg" />
                            <p class="card-text">
                                <strong>【本篇學習重點】</strong><br>
                                1. 人工髖關節置換術手術後隔天由護理人員協助指導下床。<br>
                                2. 術後需維持髖關節正確姿勢，避免翹二郎腿、彎身穿襪子、撿物或坐太低椅子。<br>
                                3. 如手術部位紅腫、滲液、發燒、人工關節異常聲響、或疼痛無法活動，請回診檢查。<br>
                            </p>
                            <div class="login-links">
                                <a href="fake_leaflet_bone.html" class="link-primary">查看更多</a>
                            </div>
        
                            <!-- 更多內容 -->
                        </div>
                    </div>
                </div>
        
                <!-- 第二个主要内容区块 -->
                <div class="col-lg-6 mb-4">
                  <div class="card custom-card">
                      <div class="card-body">
                          <h2 class="card-title" href="fake_leaflet_bone.html">上石膏病人之照護</h2>
                          <br>
                          <img width="320" height="180" src="bone2.jpg" />
                          <p class="card-text">
                              <strong>【本篇學習重點】</strong><br>
                              1. 石膏還未乾前避免壓迫，不可覆蓋床單或衣物。<br> 
                              2. 皮膚癢時不可將任何物品伸入石膏內抓癢。 <br>
                              3. 臥床時以枕頭抬高受傷肢體，減輕腫脹。 <br>
                              4. 石膏要保持清潔乾燥避免沖濕石膏。 <br>
                              5. 下床需穿著石膏鞋，以柺杖或助行器輔助行走避免跌倒。<br>
                          </p>
                          <div class="login-links">
                              <a href="fake_leaflet_bone2.html" class="link-primary">查看更多</a> 
                          </div>
                      </div>
                  </div>
                </div>

                <div class="col-lg-6 mb-4">
                  <div class="card custom-card">
                      <div class="card-body">
                          <h2 class="card-title" href="fake_leaflet_covid.html">COVID-19病人出院自我照護</h2>
                          <img width="320" height="180" src="covid.jpg" />
                          <p class="card-text">
                              <strong>【本篇學習重點】</strong><br>
                              1. 距發病日至少10天，採檢Ct值≧30，才能解除隔離。<br> 
                              2. 若有COVID-19相關症狀，請撥1922，依指示就醫。<br> 
                              3. 居家照護應多喝水、均衡飲食，並保持愉快的心情。<br>
                          </p>
                          <div class="login-links">
                              <a href="fake_leaflet_covid.html" class="link-primary">查看更多</a>
                          </div>
      
                          <!-- 更多內容 -->
                      </div>
                  </div>
                </div>
                <!-- 第四个主要内容区块 -->
                <div class="col-lg-6 mb-4">
                  <div class="card custom-card">
                      <div class="card-body">
                          <h2 class="card-title" href="fake_leaflet_bone.html">心肌炎之照護</h2>
                          <br>
                          <img width="320" height="180" src="heart.png" />
                          <p class="card-text">
                              <strong>【本篇學習重點】</strong><br>
                              1. 心肌炎在疾病初期會有類似感冒及腸胃症狀。<br> 
                              2. 治療方式可以使用藥物或手術治療。<br>
                              3. 預防感染及提升免疫力，是居家保健原則。<br> 
                          </p>
                          <div class="login-links">
                              <a href="fake_leaflet_heart.html" class="link-primary">查看更多</a>
                              
                          </div>
                          <br>
                          <br>
                      </div>
                  </div>
                </div>
            </div>
            <div id="imageGallery" ></div>

        </div>
        
        </div>
    </div>
  </body>
</html>

<script>
const admin = localStorage.getItem('admin'); // 去得lacalStorage裡的admin資訊
const user = JSON.parse(localStorage.getItem('user')); // 去得lacalStorage裡的user資訊

// 檢查user是否登入
if(admin){
  // admin登入，顯示登入按鈕
  document.getElementById('login-button').style.display = 'none';
  document.getElementById('signup-button').style.display = 'none';
  document.getElementById('logout-button').style.display = 'inline-block';
  document.getElementById('userinfo_change').style.display = 'none';
  document.getElementById('personal_medicalcare').style.display = 'none';
  document.getElementById('medical_form').style.display = 'none';
  document.getElementById('response').style.display = 'none';

}else if (user) {
  // user登入，顯示登入按鈕
  document.getElementById('login-button').style.display = 'none';
  document.getElementById('signup-button').style.display = 'none';
  document.getElementById('logout-button').style.display = 'inline-block';
  document.getElementById('leaflets_change').style.display = 'none';
  document.getElementById('manager_response').style.display = 'none';

}else {
  // user未登入，顯示登入及註冊按鈕
  document.getElementById('login-button').style.display = 'inline-block';
  document.getElementById('signup-button').style.display = 'inline-block';
  document.getElementById('logout-button').style.display = 'none';
  document.getElementById('userinfo_change').style.display = 'none';
  document.getElementById('leaflets_change').style.display = 'none';
  document.getElementById('medical_form').style.display = 'none';
  document.getElementById('personal_medicalcare').style.display = 'none';
  document.getElementById('response').style.display = 'none';
  document.getElementById('manager_response').style.display = 'none';
}

document.addEventListener('DOMContentLoaded', function() {
  const userId = JSON.parse(localStorage.getItem('user')); // 確保這裡正確地獲取用戶 ID
  fetch(`/api/user_name?userId=${userId}`) // 在請求中包含 userId 查詢參數
  .then(response => response.json())
  .then(user => {
    const userNameDisplay = document.getElementById('userNameDisplay');
    user.forEach(user_name => {
      userNameDisplay.textContent = 'Hello, ' + user_name.user_name; // 假設返回的是一個數組，並取第一個元素

    })
  })
  .catch(error => console.error('Error:', error));
});

const logoutButton = document.getElementById('logout-button');
logoutButton.addEventListener('click', function() {
  // 檢查localStorage中是否有admin資訊
  if (localStorage.getItem('admin')) {
    localStorage.removeItem('admin'); // 移除管理員資訊
    window.location.href = 'manager_login.html'; // 跳轉到管理員登入頁面
  } else if (localStorage.getItem('user')) {     // 檢查localStorage中是否有user資訊
    localStorage.removeItem('user'); // 移除使用者資訊
    window.location.href = 'user_login.html'; // 跳轉到使用者登入頁面
  }
});

fetch('/images') // 請替換成你的 API 端點
.then(response => response.json())
.then(images => {
    const gallery = document.getElementById('imageGallery');
    // 確保 gallery 存在且為 row 類型的容器
    gallery.className = 'row';
    images.forEach(image => {
        const colDiv = document.createElement('div');
        colDiv.className = 'col-md-6'; // 這會創建兩列布局
        
        const cardDiv = document.createElement('div');
        cardDiv.className = 'card mb-4 custom-card'; // card 樣式
        
        const imgElement = document.createElement('img');
        imgElement.src = image.leaflet_img;
        imgElement.className = 'card-img-top'; // Bootstrap 的圖片樣式

        const cardBodyDiv = document.createElement('div');
        cardBodyDiv.className = 'card-body';

        const titleElement = document.createElement('h5');
        titleElement.className = 'card-title';
        titleElement.textContent = image.leaflet_title;

        const textElement = document.createElement('p');
        textElement.className = 'card-text';
        textElement.textContent = image.leaflet_txt.substring(0, 130) + '...';

        const linkElement = document.createElement('a');
        linkElement.href = `leaflet_detail.html?title=${encodeURIComponent(image.leaflet_title)}`;
        // linkElement.className = 'btn btn-primary';
        linkElement.textContent = '查看更多';

        cardBodyDiv.appendChild(titleElement);
        cardBodyDiv.appendChild(textElement);
        cardBodyDiv.appendChild(linkElement);

        cardDiv.appendChild(imgElement);
        cardDiv.appendChild(cardBodyDiv);
        colDiv.appendChild(cardDiv);

        gallery.appendChild(colDiv);
    });
})
.catch(error => console.error('Error:', error));



</script>